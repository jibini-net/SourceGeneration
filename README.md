# SourceGenerationTests
Descriptor language for .NET model source code generation

Series of tests to generate a number of individual pieces of boilerplate source:
 - database repository
 - DTO model
 - partial classes
 - backend service interfaces
 - frontend HTTP client
from a simple input syntax.

```c
schema {
    int bpID,
    int bpUserID,
    string bpContent = {""}
}

partial WithComments {
    List<string> user_comments = {new()}
}

repo {
    BlogPost_GetByID(int bpID)
        => BlogPost,

    BlogPost_GetByUserID(int suID)
        => List<BlogPost>,

    BlogPost_GetWithComments(int bpID)
        => json BlogPost.WithComments,

    BlogPost_Create(int bpSiteUserID, string bpContent)
        => BlogPost
}

service {
    MakePost(string bpContent)
        => BlogPost,

    GetByUser(int suID)
        => List<BlogPost.WithComments>
}
```

... concisely describes a generated source ...

```csharp
/* DO NOT EDIT THIS FILE */
#nullable disable
namespace Generated;
public class BlogPost
{
    public int bpID { get; set; }
    public int bpUserID { get; set; }
    public string bpContent { get; set; }
        = "";
    public partial class WithComments : BlogPost
    {
        public List<string> user_comments { get; set; }
            = new();
    }
    public class Repository
    {
        //TODO Code to inject database service interface
        public BlogPost BlogPost_GetByID(int bpID)
        {
            //TODO Code to read results from proc
            return default;
            //return db.Execute<BlogPost>("BlogPost_GetByID", new { 
            //    bpID
            //});
        }
        public List<BlogPost> BlogPost_GetByUserID(int suID)
        {
            //TODO Code to read results from proc
            return default;
            //return db.Execute<List<BlogPost>>("BlogPost_GetByUserID", new { 
            //    suID
            //});
        }
        public BlogPost.WithComments BlogPost_GetWithComments(int bpID)
        {
            //TODO Code to read results from proc as json
            return default;
            //return db.ExecuteForJson<BlogPost.WithComments>("BlogPost_GetWithComments", new { 
            //    bpID
            //});
        }
        public BlogPost BlogPost_Create(int bpSiteUserID,string bpContent)
        {
            //TODO Code to read results from proc
            return default;
            //return db.Execute<BlogPost>("BlogPost_Create", new { 
            //    bpSiteUserID,
            //    bpContent
            //});
        }
    }
    public interface IService
    {
        BlogPost MakePost(string bpContent);
        List<BlogPost.WithComments> GetByUser(int suID);
    }
    public interface IBackendService : IService
    {
        // Implement and inject this interface as a separate service
    }
    public class DbService : IService
    {
        //TODO Inject database wrapper service
        private readonly IBackendService impl;
        public DbService(IBackendService impl)
        {
            this.impl = impl;
        }
        public BlogPost MakePost(string bpContent)
        {
            //TODO Code to execute via DB wrapper
            return /*wrapper.Execute<BlogPost>(() => */impl.MakePost(
                  bpContent
                  )/*)*/;
        }
        public List<BlogPost.WithComments> GetByUser(int suID)
        {
            //TODO Code to execute via DB wrapper
            return /*wrapper.Execute<List<BlogPost.WithComments>>(() => */impl.GetByUser(
                  suID
                  )/*)*/;
        }
    }
    public class ApiService : IService
    {
        //TODO Inject HTTP client service
        public ApiService()
        {
        }
        public BlogPost MakePost(string bpContent)
        {
            //TODO Code to execute via API client
            return default;
            //return api.Execute<BlogPost>("BlogPost/MakePost", new {
            //    bpContent
            //});
        }
        public List<BlogPost.WithComments> GetByUser(int suID)
        {
            //TODO Code to execute via API client
            return default;
            //return api.Execute<List<BlogPost.WithComments>>("BlogPost/GetByUser", new {
            //    suID
            //});
        }
    }
}
```
